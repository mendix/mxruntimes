import"./d5eebceb.js";import"./6727fec8.js";import"./eed44530.js";import"./aa3ddc5d.js";import{d as ensure}from"./ff203afa.js";import"./02d97a6c.js";import{d as asPureProperty}from"./71d615f7.js";import"./3019ed1f.js";import"./967e2ac0.js";import"./d9069e30.js";import{b as pageScope,c as stateUnavailable}from"./b3fab43d.js";import{a as Evaluator,b as expressionFunctions,c as createExpressionTokens,e as EmptyVariableAccessError,f as AccessDeniedError,d as Resolver}from"./4b8e45df.js";import{i as asDynamicValue,d as available,a as loading}from"./7a470c91.js";import{a as subscriptionDependency}from"./12049987.js";const evaluator=new Evaluator(expressionFunctions,createExpressionTokens(()=>new Date)),ExpressionProperty=asPureProperty((config,store)=>{const mxFormState=ensure(store.get(pageScope,"form")),resolver=new Resolver({pageTitle:()=>mxFormState[0].getTitle(),currentObject:()=>{const mxObjectState=store.get(config.scope,"object");return mxObjectState!==stateUnavailable?mxObjectState:void 0}});try{const value=evaluator.evaluate(config.expression,resolver);return resolver.getDependencies().map(dependency=>subscriptionDependency(`${dependency.tag}`,dependency)).forEach(atom=>atom.reportObserved()),asDynamicValue(available(value))}catch(e){if(e instanceof EmptyVariableAccessError||e instanceof AccessDeniedError)return asDynamicValue(loading());throw e}});export{ExpressionProperty};
