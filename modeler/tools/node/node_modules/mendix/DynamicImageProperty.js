import{Image}from"react-native";import{d as computed}from"./f0d16cff.js";import{createElement}from"react";import"./ad1d08ab.js";import{y as asDynamicValue,n as flatMapL,k as unavailable,a as available,q as loadableResource,d as mapL}from"./79cc6120.js";import{a as asProperty}from"./72a4665b.js";import"big.js";import"./6ae611dc.js";import"./b98156b5.js";import"./e7efb4be.js";import"./0e7164f2.js";import{A as Access,M as MxObject1}from"./b4a5c3fe.js";import{N as NativeFileBackend}from"./71785551.js";import{w as withObjectStoring}from"./64aaf931.js";const DynamicImageProperty=asProperty((config,store,widgetId)=>{const mxObject1Value=withObjectStoring((function(){const rootObject=MxObject1.fromState$(store.get$(config.scope,"object"));return void 0===config.path?rootObject:flatMapL(rootObject,obj=>obj.getByPath$(config.path))}),store,widgetId),pathValue=computed(()=>{const refObject=mxObject1Value.get();return flatMapL(refObject,mxObject=>{const changedDate=mxObject.get$("changedDate"),hasContents=mxObject.get$("HasContents");return changedDate.access!==Access.None&&hasContents.access!==Access.None&&hasContents.value?available(mx.data.getDocumentUrl(mxObject.getGuid(),changedDate.value?new Date(changedDate.value).getTime():null,!1)):unavailable()})}),uriResourceValue=computed(()=>{const path=pathValue.get();return loadableResource("Fetching an image",async()=>"available"!==path.status?path:available(await NativeFileBackend.readAsDataURL(path.value)))}),uriValue=computed(()=>uriResourceValue.get().get()),result=asDynamicValue(()=>mapL(uriValue.get(),uri=>props=>createElement(Image,Object.assign({source:{uri:uri}},props))));return()=>result.get()});export{DynamicImageProperty};
