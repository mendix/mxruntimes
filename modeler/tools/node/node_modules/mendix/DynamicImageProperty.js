import{Image}from"react-native";import{e as computed}from"./39c2a2fb.js";import{createElement}from"react";import"./546dec4f.js";import{a as asProperty}from"./d63ed225.js";import"./2bc24ff8.js";import"./e1d6c916.js";import"./2209f9e8.js";import"./d2546a03.js";import"./fdd4c4ff.js";import"./37fca272.js";import"./38d79760.js";import{N as NativeFileBackend}from"./c024da7a.js";import{d as asDynamicValue,m as mapL,f as flatMapL,u as unavailable,a as available}from"./6dbf3b84.js";import{l as loadableResource}from"./b4041520.js";import{A as Access,M as MxObject1}from"./2a2a8df8.js";import{w as withObjectStoring}from"./ba952791.js";const DynamicImageProperty=asProperty((config,store,widgetId)=>{const mxObject1Value=withObjectStoring(function(){const rootObject=MxObject1.fromState(store.get(config.scope,"object"));return void 0===config.path?rootObject:flatMapL(rootObject,obj=>obj.getByPath(config.path))},store,widgetId),pathValue=computed(()=>{const refObject=mxObject1Value.get();return flatMapL(refObject,mxObject=>{const changedDate=mxObject.get("changedDate"),hasContents=mxObject.get("HasContents");return changedDate.access!==Access.None&&hasContents.access!==Access.None&&hasContents.value?available(mx.data.getDocumentUrl(mxObject.getGuid(),changedDate.value?new Date(changedDate.value).getTime():null,!1)):unavailable()})}),uriResourceValue=computed(()=>{const path=pathValue.get();return loadableResource("Fetching an image",async()=>"available"!==path.status?path:available(await NativeFileBackend.readAsDataURL(path.value)))}),uriValue=computed(()=>uriResourceValue.get().get());return()=>asDynamicValue(mapL(uriValue.get(),uri=>props=>createElement(Image,Object.assign({source:{uri:uri}},props))))});export{DynamicImageProperty};
