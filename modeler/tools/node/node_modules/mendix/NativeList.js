import{View,FlatList}from"react-native";import"./39c2a2fb.js";import{Component,createElement}from"react";import{e as ensure}from"./546dec4f.js";import{w as withStore,S as StoreProvider}from"./256d19cc.js";import"./2bc24ff8.js";import{S as Store}from"./e1d6c916.js";import{f as fromObjectItem}from"./7975ceb4.js";import{p as pluckFromList,e as exclude,o as only}from"./c979549b.js";const ItemScope=withStore(class extends Component{constructor(props){super(props),this.store=new Store(this.props.$store);const{obj:obj,scope:scope}=fromObjectItem(this.props.scope);this.store.set(scope,"object",obj)}componentWillUnmount(){this.store.destroy()}render(){return createElement(StoreProvider,{store:this.store},this.props.children)}});class NativeList extends Component{shouldComponentUpdate(nextProps){return"available"===nextProps.listInfo.status}render(){const{containerStyles:containerStyles,containerExtraStyleProps:containerExtraStyleProps,listItemStyle:listItemStyle}=function(props){const containerStyles=pluckFromList(props.style,"container").map(listStyle=>exclude(listStyle,listWrapperPropKeys)),containerExtraStyleProps=pluckFromList(props.style,"container").map(listStyle=>only(listStyle,listWrapperPropKeys)).reduce((result,style)=>Object.assign({},result,style),{numColumns:props.numberOfColumns||1}),listItemStyle=pluckFromList(props.style,"listItem");return listItemStyle.unshift({flex:1/(containerExtraStyleProps.numColumns||1)}),{containerStyles:containerStyles,containerExtraStyleProps:containerExtraStyleProps,listItemStyle:listItemStyle}}(this.props),listProps=Object.assign({testID:this.props.name,refreshing:isRefreshing(this.props.listInfo.status,this.props.onPullDown),style:containerStyles,data:this.props.listInfo.value?this.props.listInfo.value.items:[],horizontal:"horizontal"===this.props.scrollDirection,listKey:this.props.id,onRefresh:this.props.onPullDown?()=>this.props.onPullDown.canExecute&&this.props.onPullDown.execute():void 0,keyExtractor:i=>i.id,renderItem:({item:item,index:index})=>createElement(ItemScope,{scope:item},createElement(View,{testID:`${this.props.name}$item${index}`,style:listItemStyle},this.props.itemTemplate())),onEndReached:()=>{const newAmount=ensure(this.props.amount.value).plus(this.props.pageSize);this.props.amount.setValue(newAmount)}},containerExtraStyleProps);return createElement(FlatList,Object.assign({},listProps))}}function isRefreshing(listInfoStatus,onPullDown){return onPullDown&&onPullDown.canExecute&&onPullDown.isExecuting||"loading"===listInfoStatus}const listWrapperPropKeys=["numColumns"];export{NativeList};
